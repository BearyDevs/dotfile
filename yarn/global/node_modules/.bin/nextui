#!/usr/bin/env node
import I from 'chalk';
import { Command } from 'commander';
import { execSync, exec } from 'child_process';
import De from 'gradient-string';
import qt from 'fast-glob';
import { resolve, basename } from 'path';
import { fileURLToPath } from 'url';
import { readFileSync, writeFileSync, existsSync, rename } from 'fs';
import Jt from 'async-retry';
import tn from 'node:path';
import { findUp } from 'find-up';
import { execSync as execSync$1 } from 'node:child_process';
import { readFileSync as readFileSync$1, writeFileSync as writeFileSync$1 } from 'node:fs';
import ft from 'prompts';
import { oraPromise } from 'ora';
import { Readable } from 'stream';
import { pipeline } from 'stream/promises';
import ln from 'tar';

var _e=["#F54180","#338EF7"],ve=De(..._e),_t=ve("NextUI CLI:"),i=class{constructor(){}static log(...t){console.log(...t);}static info(...t){console.info(...t.map(n=>I.blue(n)));}static success(...t){console.info(...t.map(n=>I.green(n)));}static warn(...t){console.warn(...t.map(n=>I.yellow(n)));}static error(...t){console.error(...t.map(n=>I.red(n)));}static gradient(t,n){this.log(De(...n?.colors??_e)(String(t)));}static prefix(t,...n){return this[t](_t,...n)}static newLine(t){t||(t=1);for(let n=0;n<t;n++)this.log();}};var L=process.cwd(),C=e=>resolve(L,e),ne=resolve(fileURLToPath(import.meta.url),"../components.json");function Ye(e,t){return i.gradient(e),t}function Be(e){return e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join("")}var j=(e,t)=>qt.sync(`${e}`,{absolute:!0,cwd:L,deep:5,ignore:["node_modules/**","dist/**","build/**","coverage/**","public/**","out/**"],onlyFiles:!0,...t});function me(e){return e==="false"?!1:!!e}function Ke(e,t){return Object.fromEntries(Object.entries(e).filter(([n])=>!t.includes(n)))}function oe(e,t){return qe(e,t)?qe(e,t):Ve(e,t)?Ve(e,t):ze(e,t)?ze(e,t):t}function qe(e,t){let n=e.split("."),o=t.split(".");return n[0]!==o[0]?I.redBright(o.join(".")):""}function Ve(e,t){let n=e.split("."),o=t.split(".");return n[1]!==o[1]?`${I.white(t[0])}${I.white(".")}${I.cyanBright(o.slice(1,3).join("."))}`:""}function ze(e,t){let n=e.split("."),o=t.split(".");return n[2]!==o[2]?`${I.white(o.slice(0,2).join("."))}${I.white(".")}${I.greenBright(o[2])}`:""}function K(e,t){let n=/([\^~])/,o=e[t].replace(n,""),r=e[t].match(n)?.[1]||"";return {currentVersion:o,versionMode:r}}function ue(e){return {npm:{install:"install",remove:"uninstall"},pnpm:{install:"add",remove:"remove"},yarn:{install:"add",remove:"remove"}}[e]}async function S(e,t){return new Promise((n,o)=>{try{let{logCmd:r=!0}=t||{};r&&(i.newLine(),i.log(`${e}`));let a=execSync(e,{stdio:"inherit",...t?Ke(t,["logCmd"]):{}});if(a){let s=a.toString();n(s);}n("");}catch(r){o(r);}})}function zt(e,t){let n=0,o=e.length,r=t.length,a=0,s=0;for(;a<o&&s<r;)e[a]===t[s]&&(n++,s++),a++;return n}function de(e,t){let n=0,o="";for(let r of e){let a=zt(r,t);a>n&&(n=a,o=r);}return o!==""?o:null}var Ae={bold:{bottomLeft:"\u2517",bottomRight:"\u251B",horizontal:"\u2501",topLeft:"\u250F",topRight:"\u2513",vertical:"\u2503"},classic:{bottomLeft:"+",bottomRight:"+",horizontal:"-",topLeft:"+",topRight:"+",vertical:"|"},double:{bottomLeft:"\u255A",bottomRight:"\u255D",horizontal:"\u2550",topLeft:"\u2554",topRight:"\u2557",vertical:"\u2551"},doubleSingle:{bottomLeft:"\u2558",bottomRight:"\u255B",horizontal:"\u2550",topLeft:"\u2552",topRight:"\u2555",vertical:"\u2502"},round:{bottomLeft:"\u2570",bottomRight:"\u256F",horizontal:"\u2500",topLeft:"\u256D",topRight:"\u256E",vertical:"\u2502"},single:{bottomLeft:"\u2514",bottomRight:"\u2518",horizontal:"\u2500",topLeft:"\u250C",topRight:"\u2510",vertical:"\u2502"},singleDouble:{bottomLeft:"\u2559",bottomRight:"\u255C",horizontal:"\u2500",topLeft:"\u2553",topRight:"\u2556",vertical:"\u2551"}};async function Wt(){if(!existsSync(ne)){await Je();return}let e="2.3.0";if(JSON.parse(readFileSync(ne,"utf-8")).version!==e){await Je();return}}async function He(){let e={};await Wt();try{e=JSON.parse(readFileSync(ne,"utf-8"));}catch(t){}return e}async function D(e){return new Promise((t,n)=>{exec(`npm view ${e} version`,(o,r)=>{o&&(i.error(`Get latest ${e} error: ${o}`),n(o)),t(r.trim());});})}var Ht=e=>`https://unpkg.com/@nextui-org/react@${e}/dist/components.json`;async function Je(){let e=Ht("2.3.0"),n={components:await Gt(e),version:"2.3.0"};writeFileSync(ne,JSON.stringify(n,null,2),"utf-8");}async function Gt(e){let t;return await Jt(async n=>{try{let o=await fetch(e,{body:null,headers:{"Content-Type":"application/json",accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"},method:"GET",mode:"cors"});t=JSON.parse(await o.text());}catch(o){n(o);}},{retries:3}),t}var R=(await He()).components,Pe=R.map(e=>e.name);R.map(e=>e.package);var Ge=new Set(Pe),F=R.reduce((e,t)=>(e[t.name]=t,e),{}),fe=["package","version","status","docs"],Xe=["package","version","status"];var Ie=/\u001b\[[\d;]+m/g,A=Ae.round,be="   ",re=`${A.vertical}${be}`,Qe=`${be}${A.vertical}${be}`;function q({commandName:e,components:t,message:n=`Current installed components:
`,warnError:o=!0}){if(!t.length){o&&i.prefix("warn","No components found");return}let r={description:0,docs:0,name:0,package:0,status:0,style:0,version:0};for(let c of t)for(let d in c)r[d]=Math.max(r[d],d==="version"?Math.max(String(c[d]).length,7):String(c[d]).length);let a=t.reduce((c,d)=>{let g=re;for(let x of fe){let l=d[x].padEnd(r[x]);if(e!=="list"&&x==="version"){let f=l.match(/([\d.]+)\snew:/)?.[1],w=l.match(/new:\s([\d.]+)/)?.[1];f===w?(l=l.replace(/\snew:\s([\d.]+)/,""),l=`${l} \u{1F680}latest`.padEnd(r[x]),l=l.replace("latest",I.magentaBright.underline("latest"))):w&&(l=`${I.white(`${f} ->`)} ${I.yellowBright(`${w} (new)`)}`,r[x]=Math.max(l.replace(/(\u001b\[\d+m)/g,"").length,r[x]));}d.status==="stable"&&Xe.includes(x)?l=I.greenBright(l):d.status==="new"?l=I.magentaBright(l):d.status==="updated"&&(l=I.blueBright(l)),g+=l+Qe;}return c.push(g),c},[]),s=A.topLeft+re.replace(/.*/g,A.horizontal).slice(1),p=re,m=A.vertical+re.replace(/.*/g,A.horizontal).slice(1);for(let c of fe)s+=`${A.horizontal.padEnd(r[c]+7,A.horizontal)}`,p+=I.redBright(Be(c).padEnd(r[c]))+Qe,m+=`${A.horizontal.padEnd(r[c]+7,A.horizontal)}`;s=s.slice(0,-2)+A.topRight,m=m.slice(0,-2)+A.vertical;let u=A.bottomLeft+re.replace(/.*/g,A.horizontal).slice(1);for(let c of fe)u+=`${A.horizontal.padEnd(r[c]+7,A.horizontal)}`;u=u.slice(0,-2)+A.bottomRight,a=[s,p,m,...a,u],i.info(n),i.log(a.join(`
`));}function Ze(){i.newLine(),i.log(I.redBright("Environment Info:")),i.log(I.blueBright("  System:")),i.log(I.blueBright("    OS:"),process.platform),i.log(I.blueBright("    CPU:"),process.arch),i.log(I.greenBright("  Binaries:")),i.log(I.greenBright("    Node:"),process.version),i.newLine();}function ie({borderStyle:e="round",center:t=!1,color:n,log:o=!0,padding:r=0,text:a,title:s}){let p=Ae[e],m=n?Object.fromEntries(Object.entries(p).map(([$,U])=>[$,I[n](U)])):p,u=a.split(`
`),c=u.map($=>$.replace(Ie,"")),d=r>0,g=r,x=t||d,l=c.reduce(($,U)=>U.length>$?U.length:$,0);l=d?l+g*4:l;let f=s?s.replace(Ie,""):"",w=s?f.length:0,v=l-w,h=2;for(;w+h+g>=l;)l+=Math.floor(w/2);v=l-w;let k=s?`${p.horizontal.padEnd(Math.floor(v/2)-1,p.horizontal).replaceAll(p.horizontal,m.horizontal)} ${s} ${p.horizontal.padEnd(Math.ceil(v/2)-1,p.horizontal).replaceAll(p.horizontal,m.horizontal)}`:p.horizontal.padEnd(l,p.horizontal).replaceAll(p.horizontal,m.horizontal),T=m.topLeft+k+m.topRight,ke=m.bottomLeft+p.horizontal.padEnd(l,p.horizontal).replaceAll(p.horizontal,m.horizontal)+m.bottomRight,B=u.reduce(($,U)=>{let Mt=U.replace(Ie,""),te=l-Mt.length,Ot=" ".repeat(te),Oe=Math.floor(te/2),je=Math.ceil(te/2),jt=Oe>0?" ".repeat(Oe):"",Dt=je>0?" ".repeat(je):"";return x?$.push(`${m.vertical}${te?`${jt}${U}${Dt}`:U}${m.vertical}`):$.push(`${m.vertical}${te>0?`${U}${Ot}`:U}${m.vertical}`),$},[]);if(x)for(let $=0;$<g;$++)B.unshift(`${m.vertical}${" ".repeat(l)}${m.vertical}`),B.push(`${m.vertical}${" ".repeat(l)}${m.vertical}`);return B=[T,...B,ke],o&&i.log(B.join(`
`)),B.join(`
`)}var se={name:"nextui-cli",private:!1,type:"module",license:"MIT",version:"0.1.5",homepage:"https://github.com/nextui-org/nextui-cli#readme",description:"A CLI tool that unlocks seamless NextUI integration",keywords:["UI","CLI","Tool","NextUI","Template","Integration","Add Component"],author:{name:"NextUI",email:"support@nextui.org",url:"https://github.com/nextui-org"},repository:{type:"git",url:"https://github.com/nextui-org/nextui-cli.git"},bugs:{url:"https://github.com/nextui-org/nextui-cli/issues"},publishConfig:{access:"public"},files:["dist"],bin:{nextui:"./dist/index.js"},main:"./dist/index.js",module:"./dist/index.js",types:"./dist/index.d.ts",scripts:{dev:"tsup --watch","link:cli":"pnpm link --global","link:remove":"pnpm uninstall --global nextui-cli",build:"tsup","update:components":"tsx src/scripts/update/update-components.ts",lint:"eslint . --max-warnings=0","lint:fix":"eslint . -max-warnings=0 --fix","check:prettier":"prettier --check .","check:types":"tsc --noEmit",changelog:"npx conventional-changelog -p angular -i CHANGELOG.md -s --commit-path . && git add .",release:"bumpp --execute='pnpm run changelog'",prepare:"husky install",postbuild:"pnpm run update:components",prepublishOnly:"pnpm run build"},dependencies:{"async-retry":"1.3.3",chalk:"5.3.0",commander:"11.0.0","fast-glob":"3.3.2","find-up":"7.0.0","gradient-string":"2.0.2",ora:"8.0.1",prompts:"2.4.2",tar:"6.2.1"},devDependencies:{"@commitlint/cli":"17.7.1","@commitlint/config-conventional":"17.7.0","@types/gradient-string":"1.1.3","@types/node":"20.11.30","@types/prompts":"2.4.9","@typescript-eslint/eslint-plugin":"6.7.2","@typescript-eslint/parser":"6.7.2",bumpp:"9.4.0","clean-package":"2.2.0","commitlint-plugin-function-rules":"2.0.2","conventional-changelog-cli":"4.1.0",eslint:"8.50.0","eslint-config-prettier":"9.0.0","eslint-import-resolver-typescript":"3.6.1","eslint-plugin-import":"2.28.1","eslint-plugin-prettier":"5.0.0","eslint-plugin-sort-destructure-keys":"1.5.0","eslint-plugin-sort-keys-fix":"1.1.2","eslint-plugin-unused-imports":"3.0.0",husky:"8.0.3","lint-staged":"14.0.1",tsup:"7.2.0",tsx:"4.7.1",typescript:"5.4.4"},engines:{pnpm:">=8.x",node:">=18.17.x"},packageManager:"pnpm@8.7.6"};function P(e,t=!0){let n;try{n=JSON.parse(readFileSync(e,"utf-8"));}catch(u){i.prefix("error",`Error reading package.json file: ${e} 
Error: ${u}`);}let o=n.devDependencies||{},r=n.dependencies||{},a={...o,...r},s=new Set(Object.keys(a)),p=R.filter(u=>{if(s.has(u.package)){let{currentVersion:c,versionMode:d}=K(a,u.package);return u.version=t?`${c} new: ${u.version}`:c,u.versionMode=d,!0}return !1}),m=s.has(y);return {allDependencies:a,allDependenciesKeys:s,currentComponents:p,dependencies:r,devDependencies:o,isAllComponents:m,package:n}}function et(e){return e.map(t=>{let o=F[t]?.package;return o||t})}async function tt(e,t,n=!0){let o=[];for(let r of e){let{currentVersion:a}=K(t,r),{versionMode:s}=K(t,r),p=(await S(`npm show ${r} homepage`,{logCmd:!1,stdio:"pipe"})||"").replace(/\n/,""),m=(await S(`npm show ${r} description`,{logCmd:!1,stdio:"pipe"})||"").replace(/\n/,""),u=await D(r);a=n?`${a} new: ${u}`:a;let c={description:m||"",docs:p||"",name:r,package:r,status:"stable",style:"",version:a,versionMode:s};o.push(c);}return o}var ae="framer-motion",pe="tailwindcss",y="@nextui-org/react",J="@nextui-org/theme",W="@nextui-org/system";var $e="https://nextui.org/docs/guide/installation#global-installation",ge="https://nextui.org/docs/guide/installation#tailwind-css-setup";var nt="https://nextui.org/docs/guide/installation#setup-pnpm-optional",he="https://nextui.org/docs/guide/installation#provider-setup",b={content:"./node_modules/@nextui-org/theme/dist/**/*.{js,ts,jsx,tsx}",darkMode:'darkMode: "class"',importContent:(e=!1)=>e?"import {nextui} from '@nextui-org/theme';":"const {nextui} = require('@nextui-org/theme');",plugins:"nextui()"},xe={content:(e,t)=>{e.forEach(r=>{let a=ot(r,t);e.push(...a);});let n=[...new Set(e.map(r=>r.style||r.name))];return n.length===1?`./node_modules/@nextui-org/theme/dist/components/${e[0]}.js`:`./node_modules/@nextui-org/theme/dist/components/(${n.reduce((r,a)=>r+=`${a}|`,"").replace(/\|$/,"")}).js`},plugins:"nextui()"},Te={import:"NextUIProvider"},E={content:"public-hoist-pattern[]=*@nextui-org/*"};function ot(e,t){let n=e.name,o=C(`node_modules/@nextui-org/${n}`),r=[e];if(!existsSync(o)&&t){let s=C("node_modules/.pnpm"),p=qt.sync(`**/@nextui-org/${n}`,{absolute:!0,cwd:s,onlyDirectories:!0})[0];if(p)o=p;else return r}let{currentComponents:a}=P(`${o}/package.json`);if(a.length)for(let s of a){let p=ot(s,t);r.push(...p);}return r}function rt(e){let t=/import {?\s*([\w\W]+?)\s*}? from ['"](.+)['"]/g,n=e.match(t)??[],o=[];for(let a of n)o.push(r(a));return o.length?o:[];function r(a){let s=/import {?\s*([\w\W]+?)\s*}? from ['"](.+)['"]/,p=a.match(s)??[];return [p[1]??"",p[2]??""]}}function M(e,t){let n=new RegExp(`\\s*${e}:\\s\\[([\\w\\W]*?)\\]\\s*`);return n.test(t)?t.match(n)?.[1]?.split(/,\n/).map(o=>o.trim().replace(/[`'"]/g,"")).filter(Boolean)??[]:[]}function H(e,t,n,o){let r=new RegExp(`\\s*${e}:\\s\\[([\\w\\W]*?)\\]\\s*`),a=o??n.map(c=>JSON.stringify(c)).join(", ");if(r.test(t)){let c=e==="content"?`
  ${e}: [${a}]`:`
  ${e}: [${n}]`;return t.replace(r,c)}let s=t.split(`
`),p=s.findIndex(c=>c.includes("content:")),m=s.findIndex(c=>c.includes("module.exports =")),u=p!==-1?p:m!==-1?m:0;return e==="content"?s.splice(u+1,0,`  ${e}: [${a}],`):s.splice(u+1,0,`  ${e}: [${n.map(c=>c.replace(/['"`]/g,""))}],`),s.join(`
`)}function V(e,t){let{errorInfo:n,missingDependencies:o,tailwindName:r}=t;return e==="missingDependencies"?{level:"error",name:"missingDependencies",outputFn:()=>{i.error("You have not installed the required dependencies"),i.newLine(),i.info("The required dependencies are:"),o.forEach(a=>{i.info(`- ${a}`);}),i.newLine(),i.info(`See more info here: ${$e}`);}}:e==="incorrectTailwind"?{level:"error",name:"incorrectTailwind",outputFn:()=>{i.error(`Your ${r} is incorrect`),i.newLine(),i.info("The missing part is:"),n.forEach(a=>{i.info(`- need to add ${a}`);}),i.newLine(),i.error(`See more info here: ${ge}-1`);}}:{level:"error",name:"incorrectApp",outputFn:()=>{i.error("Your App.tsx is incorrect"),i.newLine(),i.info("The missing part is:"),n.forEach(a=>{i.info(`- need to add ${a}`);}),i.newLine(),i.error(`See more info here: ${$e}`);}}}function G(e,t){let n=[];if(e==="all"){let o=t.has(y),r=t.has(ae),a=t.has(pe);if(o&&r)return [!0];!o&&n.push(y),!r&&n.push(ae),!a&&n.push(pe);}else if(e==="partial"){let o=t.has(ae),r=t.has(pe),a=t.has(W),s=t.has(J);if(o&&a&&s)return [!0];!o&&n.push(ae),!a&&n.push(W),!s&&n.push(J),!r&&n.push(pe);}return [!1,...n]}function z(e,t,n,o,r){if(e==="partial"&&!n.length)return [!0];let a=[],s=r??readFileSync(t,"utf-8"),p=M("content",s),m=M("plugins",s);if(e==="all"){let u=s.match(/darkMode: ["']\w/),c=p.some(g=>g.includes(b.content)),d=m.some(g=>g.includes(b.plugins));if(u&&c&&d)return [!0];!u&&a.push(b.darkMode),!c&&a.push(b.content),!d&&a.push(b.plugins);}else if(e==="partial"){let u=xe.content(n,o),c=p.some(g=>g.includes(u)),d=m.some(g=>g.includes(b.plugins));if(c&&d)return [!0];!c&&a.push(u),!d&&a.push(b.plugins);}return [!1,...a]}function ce(e,t){let n=[];if(e==="all"||e==="partial"){let o=readFileSync(t,"utf-8"),a=rt(o).some(([s])=>s.includes(Te.import));if(a)return [!0];!a&&n.push(Te.import);}return [!1,...n]}function we(e){let t=[],n;if(e){try{n=readFileSync(e,"utf-8");let o=n.includes(E.content);if(o)return [!0];!o&&t.push(E.content);}catch(o){t.push(`Error reading .npmrc file: ${e} 
Error: ${o}`);}return [!1,...t]}return [!1,...t]}function X(e,t=!0){let n=[];for(let o of e)if(!Ge.has(o)){let r=de(Pe,o);n.push([o,r]);}if(n.length){let[o,r]=n.reduce((a,[s,p])=>[a[0]+I.underline(s)+", ",a[1]+(p?I.underline(p)+", ":"")],["",""]);return t&&i.prefix("error",`Illegal components: ${o.replace(/, $/,"")}${r?`
${"".padEnd(12)}It may be a typo, did you mean ${r.replace(/, $/,"")}?`:""}`),!1}return !0}var st={"bun.lockb":"bun","npm-shrinkwrap.json":"npm","package-lock.json":"npm","pnpm-lock.yaml":"pnpm","yarn.lock":"yarn"};async function O(e=L){let t="npm",n=await findUp(Object.keys(st),{cwd:e});return n&&(t=st[tn.basename(n)]),t}function at(e,t){let{format:n=!1,write:o=!0}=t,r=readFileSync$1(e,"utf-8");r=`import {NextUIProvider} from "@nextui-org/react";
${r}`,r=on(r),o&&writeFileSync$1(e,r,"utf-8"),n&&execSync$1(`npx prettier --write ${e}`,{stdio:"ignore"});}function on(e){let t=/return\s*\(([\s\S]*?)\);/g;return e.replace(t,(o,r)=>`return (
      <NextUIProvider>
        ${r.trim()}
      </NextUIProvider>
    );`)}function ye(e,t){let{errorInfoList:n,format:o=!1,tailwindPath:r,write:a=!0}=t;if(!n.length)return;let s=readFileSync$1(r,"utf-8"),p=M("content",s),m=M("plugins",s);for(let u of n){let[c,d]=rn(u);if(c==="content"){if(p.includes(b.content))continue;p=p.filter(x=>!x.includes("@nextui-org/theme/dist/")),p.push(d),s=H("content",s,p,p.map((x,l,f)=>l===0?f.length===1?`
    ${JSON.stringify(x)}
`:`
    ${JSON.stringify(x)}`:f.length-1===l?`    ${JSON.stringify(x)}
  `:`    ${JSON.stringify(x)}`).join(`,
`));}else c==="plugins"&&(m.push(d),s=H("plugins",s,m),s=`${b.importContent(r.endsWith(".ts"))}
${s}`);if(e==="all"&&c==="darkMode"){let g=s.indexOf("plugins")-1,x=b.darkMode;s=`${s.slice(0,g)} ${x},
${s.slice(g)}`;}}if(a&&writeFileSync$1(r,s,"utf-8"),o)try{execSync$1(`npx prettier --write ${r}`,{stdio:"ignore"});}catch{i.warn(`Prettier failed to format ${r}`);}}function rn(e){return b.darkMode.includes(e)?["darkMode",e]:b.plugins.includes(e)?["plugins",e]:["content",e]}function pt(e,t=!0,n=!0){let o=readFileSync$1(e,"utf-8");o=`${E.content}
${o}`,t&&writeFileSync$1(e,o,"utf-8"),i.newLine(),i.info(`Added the required content in file: ${e}`),n&&(i.newLine(),i.info("Pnpm restructure will be run now"),n&&execSync$1("pnpm install",{stdio:"inherit"}));}var ct="https://codeload.github.com/nextui-org/next-app-template/tar.gz/main",lt="https://codeload.github.com/nextui-org/next-pages-template/tar.gz/main",mt="next-app-template-main",ut="next-pages-template-main";function dt(e,t){return e==="all"?`// tailwind.config.js
const {nextui} = require("@nextui-org/react");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./node_modules/@nextui-org/theme/dist/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  darkMode: "class",
  plugins: [nextui()],
};`:`// tailwind.config.js
const {nextui} = require("@nextui-org/theme");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    ${JSON.stringify(t)},
  ],
  theme: {
    extend: {},
  },
  darkMode: "class",
  plugins: [nextui()],
};`}var gt={onCancel:()=>{i.log(`${I.red("\u2716")} Operation cancelled`),process.exit(0);}};async function Q(e,t){return (await ft({hint:"- Space to select. Return to submit",message:e,min:1,name:"value",type:"autocompleteMultiselect",...t?{choices:t}:{}},gt)).value}async function Z(e,t){return (await ft({message:e,name:"value",type:"select",...t?{choices:t}:{}},gt)).value}async function wt(e,t){let{addApp:n=!1,all:o=!1,appPath:r=j("**/App.(j|t)sx")[0],packagePath:a=C("package.json"),prettier:s=!1,tailwindPath:p=j("**/tailwind.config.(j|t)s")[0]}=t;var{allDependencies:m,allDependenciesKeys:l,currentComponents:f}=P(a);let u=!!m[y];if(!e.length&&!o?e=await Q("Which components would you like to add?",R.filter(h=>!f.some(k=>k.name===h.name)).map(h=>({description:h.description,title:h.name,value:h.name}))):o&&(e=[y]),!o&&!X(e))return;var{allDependenciesKeys:l,currentComponents:f}=P(a);let c=f.map(h=>h.name),d=e.filter(h=>c.includes(h)||u&&h===y);if(d.length){i.prefix("error",`\u274C You have added the following components: ${d.map(h=>I.underline(h)).join(", ")}`);return}if(n&&!r){i.prefix("error","\u274C App.(j|t)sx file not found. Please specify the appPath if the default search path does not locate your file.  'add --appPath=yourAppPath'");return}let g=await O(),x=g==="npm"?"install":"add";if(o){let[,...h]=G("all",l);h.length&&(i.info(`Adding required dependencies: ${[...h].map(k=>I.underline(k)).join(", ")}`),await S(`${g} ${x} ${[...h].join(" ")}`));}else {let[,...h]=G("partial",l),k=[...h,...e.map(T=>F[T].package)];i.info(`Adding required dependencies: ${[...k].map(T=>I.underline(T)).join(", ")}`),await S(`${g} ${x} ${[...k].join(" ")}`);}var{allDependenciesKeys:l,currentComponents:f}=P(a);let w=o?"all":"partial",v=g==="pnpm";if(p){let[,...h]=z(w,p,f,v);ye(w,{errorInfoList:h,format:s,tailwindPath:p}),i.newLine(),i.info(`Tailwind CSS settings have been updated in: ${p}`);}else {let h=xe.content(f,v),k=dt(w,h),T=C("tailwind.config.js");writeFileSync(T,k,"utf-8"),i.newLine(),i.info(`Tailwind CSS configuration file created at: ${T}`);}if(n&&r&&existsSync(r)){let[h]=ce(w,r);h||(at(r,{format:s}),i.newLine(),i.info(`NextUIProvider successfully added to the App file at: ${r}`),i.warn("Please check the placement of NextUIProvider in the App file to ensure it's correctly integrated.'"));}if(g==="pnpm"){let h=C(".npmrc");if(!existsSync(h))writeFileSync(C(".npmrc"),E.content,"utf-8");else {let[k]=we(h);k||pt(h);}}i.newLine(),i.success("\u2705 Components added successfully"),i.warn(`Please check the ${I.bold("NextUIProvider")} whether in the correct place (ignore if added)
See more info here: ${he}`),(l.has(y)||o)&&f.length&&(i.newLine(),i.warn("Attention: Individual components from NextUI do not require the `@nextui-org/react` package. For optimized bundle sizes, consider using individual components."),i.warn("The redundant dependencies are:"),f.forEach(h=>{i.info(`- ${h.package}`);})),process.exit(0);}async function Ct(e){let{appPath:t=j("**/App.(j|t)sx")[0],checkApp:n=!1,checkPnpm:o=!0,checkTailwind:r=!0,packagePath:a=C("package.json"),tailwindPath:s=j("**/tailwind.config.(j|t)s")}=e,p=me(n),m=me(o),u=me(r),c=[s].flat(),{allDependenciesKeys:d,currentComponents:g,isAllComponents:x}=P(a);if(!g.length&&!x){i.prefix("error",`\u274C No ${I.underline("NextUI components")} found in your project. Please consult the installation guide at: https://nextui.org/docs/guide/installation#global-installation`);return}let l=[];if(x&&g.length&&l.push({level:"warn",name:"redundantDependencies",outputFn:()=>{i.warn("You have installed some unnecessary dependencies. Consider removing them for optimal performance."),i.newLine(),i.info("The following dependencies are redundant:"),g.forEach(f=>{i.info(`- ${f.package}`);});}}),u&&!c.length&&l.push({level:"error",name:"missingTailwind",outputFn:()=>{i.error("Missing tailwind.config.(j|t)s file. To set up, visit: "+ge);}}),p&&!t&&l.push({level:"error",name:"missingApp",outputFn:()=>{i.error("App.(j|t)sx file not found. Please specify the path using: doctor --appPath=[yourAppPath]");}}),x){let[f,...w]=G("all",d);if(f||l.push(V("missingDependencies",{missingDependencies:w})),u)for(let v of c){let[h,...k]=z("all",v);if(!h){let T=basename(v);l.push(V("incorrectTailwind",{errorInfo:k,tailwindName:T}));}}if(p&&t){let[v,...h]=ce("all",t);v||l.push(V("incorrectApp",{errorInfo:h}));}}else if(g.length){let[f,...w]=G("partial",d);if(f||l.push(V("missingDependencies",{missingDependencies:w})),u){let v=await O()==="pnpm";for(let h of c){let[k,...T]=z("partial",h,g,v);if(!k){let ke=basename(h);l.push(V("incorrectTailwind",{errorInfo:T,tailwindName:ke}));}}}if(p&&t){let[v,...h]=ce("partial",t);v||l.push(V("incorrectApp",{errorInfo:h}));}}if(m&&await O()==="pnpm"){let w=C(".npmrc"),[v,...h]=we(w);v||l.push({level:"error",name:"incorrectPnpm",outputFn:()=>{i.error("The pnpm setup is incorrect. Please update your configuration according to the guidelines provided at: "+nt),i.newLine(),i.info("Required changes:"),h.forEach(k=>{i.info(`- Add ${k}`);});}});}if(!l.length){i.success("\u2705 Your project has no detected issues.");return}i.prefix("error",`\u274C Your project has ${I.underline(l.length)} issue${l.length===1?"":"s"} that require attention`),i.newLine();for(let f=0;f<l.length;f++){let w=l[f];i[w.level](`\u2757\uFE0FIssue ${f+1}: ${I.bold(w.name)}`),i.newLine(),w.outputFn(),i.newLine();}process.exit(0);}async function kt(e){let{packagePath:t=C("package.json")}=e,{currentComponents:n}=P(t);q({components:n}),Ze(),process.exit(0);}async function mn(e){let t=await fetch(e);if(!t.body)throw new Error(`Failed to download: ${e}`);return Readable.fromWeb(t.body)}async function vt(e,t){await Jt(async n=>{try{await pipeline(await mn(t),ln.x({cwd:e}));}catch(o){n(new Error(`Failed to download ${t} Error: ${o}`));}},{retries:3});}async function It(e,t){let{package:n,template:o}=t;o||(o=await Z("Select a template",[{description:"A Next.js 13 with app directory template pre-configured with NextUI (v2) and Tailwind CSS.",title:I.blue("App"),value:"app"},{description:"A Next.js 13 with pages directory template pre-configured with NextUI (v2) and Tailwind CSS.",title:I.red("Pages"),value:"pages"}])),n||(n="npm"),o==="app"?(await At(ct),e&&Pt(mt,e)):o==="pages"&&(await At(lt),e&&Pt(ut,e)),process.exit(0);}async function At(e){await oraPromise(vt(L,e),{failText(t){i.prefix("error",`downloadTemplate Error: ${t}`),process.exit(1);},successText:(()=>(i.newLine(),I.greenBright("Template created successfully!")))(),text:"Creating template..."});}function Pt(e,t){rename(`${L}/${e}`,`${L}/${t}`,n=>{n&&i.prefix("warn",`rename Error: ${n}`);});}async function bt(e){let{packagePath:t=C("package.json"),remote:n=!1}=e,o=R;try{if(!n){let{currentComponents:r}=await P(t);o=r;}if(!o.length){i.warn(`No NextUI components detected in the specified package.json at: ${t}`);return}n?q({commandName:"list",components:o}):q({components:o});}catch(r){i.prefix("error",`An error occurred while attempting to list the components: ${r}`);}process.exit(0);}async function $t(e,t){let{remove:n}=ue(t);await S(`${t} ${n} ${e.reduce((o,r)=>`${o} ${r}`,"")}`);}async function Tt(e,t){let{currentComponents:n,isNextUIAll:o,isPnpm:r,prettier:a,tailwindPath:s}=t;if(s&&!existsSync(s)){i.prefix("warn","No tailwind.config.(j|t)s found remove action skipped");return}let p=readFileSync(s,"utf-8"),m=M("content",p),u=M("plugins",p);if(!n.length&&!o){let d=u.findIndex(g=>g.includes("nextui"));d!==-1&&u.splice(d,1),p=H("plugins",p,u),p=p.replace(/(const|var|let|import)[\w\W]+?nextui.*?;\n/,"");}for(;m.some(d=>d.includes("nextui"));)m.splice(m.findIndex(d=>d.includes("nextui")),1);p=H("content",p,m),writeFileSync(s,p,"utf-8");let[,...c]=z(e,s,n,r);ye(e,{errorInfoList:c,format:a,tailwindPath:s}),i.newLine(),i.info(`Remove the removed components tailwind content in file: ${s}`);}async function Ut(e,t){let{all:n=!1,packagePath:o=C("package.json"),prettier:r=!1,tailwindPath:a=j("**/tailwind.config.(j|t)s")[0]}=t;var{allDependencies:g,currentComponents:x}=P(o);let s=await O(),p=!!g[y];if(!x.length&&!p){i.prefix("error",`No NextUI components detected in your package.json at: ${o}`);return}if(n||p)e=p?[y]:x.map(f=>f.package);else if(!e.length)e=await Q("Select the components to remove",x.map(f=>({title:f.package,value:f.package})));else {if(!X(e))return;e=et(e);}let m=e.includes(y)?await tt(e,g):x.filter(f=>e.some(w=>w.includes(f.package)||w.includes(f.name)));q({components:m,message:I.yellowBright("\u2757\uFE0F Components slated for removal:")}),await Z("Confirm removal of these components:",[{title:"Yes",value:!0},{title:"No",value:!1}])||process.exit(0);let c=[...e];x.filter(f=>!e.includes(f.package)).length||(g[J]&&c.push(J),g[W]&&c.push(W)),await $t(c,s);var{allDependencies:g,currentComponents:x}=P(o,!1);if(p=!!g[y],Tt(p?"all":"partial",{currentComponents:x,isNextUIAll:p,isPnpm:s==="pnpm",prettier:r,tailwindPath:a}),!x.length&&!p){if(s==="pnpm"){let f=C(".npmrc");if(existsSync(f)){let w=readFileSync(f,"utf-8");w=w.replace(E.content,""),i.newLine(),i.info("Removing specified .npmrc file content"),writeFileSync(f,w,"utf-8");}}i.newLine(),i.warn(`No NextUI components remain installed. Ensure the NextUIProvider is also removed if necessary.
For more information, visit: ${he}`);}i.newLine(),i.success(`\u2705 Successfully removed the specified NextUI components: ${e.map(f=>I.underline(f)).join(", ")}`),process.exit(0);}var ee="".padEnd(7);function Nt(e){if(!e.length)return "";let t=[],n={latestVersion:0,package:0,version:0};for(let o of e)for(let r in o)n[r]=Math.max(n[r],o[r].length);for(let o of e){if(o.isLatest){t.push(`  ${I.white(`${`${o.package}@${o.versionMode||""}${o.latestVersion}`.padEnd(n.package+ee.length+ee.length)}`)}${I.greenBright("latest").padStart(n.version)}${ee}`);continue}t.push(`  ${I.white(`${o.package.padEnd(n.package+ee.length)}${ee}${o.versionMode||""}${o.version.padStart(n.version)}  ->  ${o.versionMode||""}${o.latestVersion}`)}${ee}`);}return t.join(`
`)}async function Lt(e){let{allDependencies:t,isNextUIAll:n}=e,{upgradeOptionList:o}=e,r=[];if(n){let a=await D(y),{currentVersion:s,versionMode:p}=K(t,y),m=oe(s,a),u=a===s,c=Nt([{isLatest:u,latestVersion:m,package:y,version:s,versionMode:p}]);ie({text:c}),u||r.push({isLatest:u,latestVersion:a,package:y,version:s,versionMode:p});}else {let a=o.map(p=>({...p,latestVersion:oe(p.version,p.latestVersion)})),s=Nt(a);ie({text:s}),r=o.filter(p=>!p.isLatest);}return r}async function Et(e,t){let{all:n=!1,packagePath:o=C("package.json")}=t,{allDependencies:r,currentComponents:a}=P(o,!1),s=!!r[y],p=[];for(let c of a){let d=await D(c.package);p.push({...c,isLatest:c.version===d,latestVersion:d});}if(!p.length&&!s){i.prefix("error",`No NextUI components detected in your package.json at: ${o}`);return}if(s)e=[y];else if(n)e=a.map(c=>c.package);else if(!e.length)e=await Q("Select the components to upgrade",p.map(c=>{let d=c.version===c.latestVersion;return {disabled:d,title:`${c.package} ${d?I.greenBright("Already up to date"):`${I.gray(`${c.version} ->`)} ${oe(c.version,c.latestVersion)}`}`,value:c.package}}));else if(!X(e))return;e=e.map(c=>F[c]?.package?F[c].package:c);let m=p.filter(c=>e.includes(c.package)),u=await Lt({allDependencies:r,isNextUIAll:s,upgradeOptionList:m});if(u.length&&await Z("Would you like to proceed with the upgrade?",[{title:"Yes",value:!0},{title:"No",value:!1}])){let d=await O(),{install:g}=ue(d);await S(`${d} ${g} ${u.reduce((x,l)=>`${x} ${l.package}@${l.latestVersion}`,"")}`);}i.newLine(),i.success("\u2705 Upgrade complete. All components are up to date."),process.exit(0);}var kn=["add","env","init","list","upgrade","doctor","remove"],N=new Command;N.name("nextui").usage("[command]").description(`${I.blue(Ye(`
NextUI CLI v${se.version}
`,""))}`).version(se.version,"-v, --version","Output the current version").helpOption("-h, --help","Display help for command").allowUnknownOption().action(async(e,t)=>{let n=!1;if(t){let o=t.args?.[0];if(o){n=!0;let r=de(kn,o);r?i.error(`Unknown command '${o}', Did you mean '${I.underline(r)}'?`):i.error(`Unknown command '${o}'`);}}if(!n){let r=(await S("nextui --help",{logCmd:!1,stdio:"pipe"})).split(`
`);r=r.filter(a=>a&&!a.includes("NextUI CLI v")),r=r.map(a=>{let s=a.match(/(\w+)\s\[/)?.[1];return s?a.replace(s,I.cyan(s)):a}),i.log(r.join(`
`));}process.exit(0);});N.command("init").description("Initializes a new project").argument("[projectName]","Name of the project to initialize").option("-t --template [string]","Specify a template for the new project, e.g., app, pages").action(It);N.command("add").description("Adds components to your project").argument("[components...]","Names of components to add").option("-a --all [boolean]","Add all components",!1).option("-p --packagePath [string]","Specify the path to the package.json file").option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").option("-app --appPath [string]","Specify the path to the App.tsx file").option("--prettier [boolean]","Apply Prettier formatting to the added content",!1).option("--addApp [boolean]","Include App.tsx file content that requires a provider",!1).action(wt);N.command("upgrade").description("Upgrades project components to the latest versions").argument("[components...]","Names of components to upgrade").option("-p --packagePath [string]","Specify the path to the package.json file").option("-a --all [boolean]","Upgrade all components",!1).action(Et);N.command("remove").description("Removes components from the project").argument("[components...]","Names of components to remove").option("-p --packagePath [string]","Specify the path to the package.json file").option("-a --all [boolean]","Remove all components",!1).option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").action(Ut);N.command("list").description("Lists all components, showing status, descriptions, and versions").option("-p --packagePath [string]","Specify the path to the package.json file").option("-r --remote","List all components available remotely").action(bt);N.command("env").description("Displays debugging information for the local environment").option("-p --packagePath [string]","Specify the path to the package.json file").action(kt);N.command("doctor").description("Checks for issues in the project").option("-p --packagePath [string]","Specify the path to the package.json file").option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").option("-app --appPath [string]","Specify the path to the App.tsx file").option("-ca --checkApp [boolean]","Check the App.tsx file",!1).option("-ct --checkTailwind [boolean]","Check the tailwind.config.js file",!0).option("-cp --checkPnpm [boolean]","Check for Pnpm",!0).action(Ct);N.hook("preAction",async()=>{let e=se.version,t=await D(se.name);e!==t&&(ie({color:"yellow",padding:1,text:`${I.gray(`Available upgrade: v${e} -> ${I.greenBright(`v${t}`)}
Run \`${I.cyan("npm install nextui-cli@latest")}\` to upgrade
Changelog: ${I.underline("https://github.com/nextui-org/nextui-cli/releases")}`)}`,title:ve("NextUI CLI")}),i.newLine());});N.parseAsync(process.argv).catch(async e=>{i.newLine(),i.error("Unexpected error. Please report it as a bug:"),i.log(e),i.newLine(),process.exit(1);});
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map